import{S as W,O as j,G as k,D as U}from"./OrbitControls-DgKsolBe.js";import{f as N,r as V,M as q,O as Q,b0 as X,b1 as Y,s as h,b2 as Z,a$ as L,aO as F,b3 as $,H as K,W as J,aQ as ee,P as te,a as se,G as ne,c as re,R as ae,C as I,aD as oe,aF as ie,g as ce,_ as de,b4 as le,b5 as pe,o as ue}from"./three.module-B7XIeoLg.js";import{a as he,M as me}from"./MODEL_LIST-Dp8f6OQf.js";import{B as ye}from"./BG_ENV-Bz50PIaW.js";import{T as fe,G as ge}from"./tween.esm-BunxfTqY.js";import{H as we}from"./HDRI_LIST-DJCqOZOR.js";import{L as Ce}from"./LoadingHelper-Bpwvv_dV.js";import"./EXRLoader-BPNILuzU.js";import"./HDRLoader-bbCJO4Nb.js";import"./GroundProjectedSkybox-C9rVnbDD.js";class be{constructor({resolution:t=896,segments:r=64,zoom:s=0}={}){this.resolution=t,this.segments=r,this.zoom=s,this.renderTarget=this.createRenderTarget(t);const n=new N(1,r,r),o=new V({envMap:this.renderTarget.texture});this.sphereMesh=new q(n,o),this.orthoCamera=new Q,this.cubeCamera=new X(.1,1e3,this.renderTarget),this.temp={t:new h,r:new F,s:new h,e:new L(0,Math.PI,0),sphere:new Z,normal:new h,normalMatrix:new Y},this.onResize(100,100)}createRenderTarget(t){const r=new $(t,{stencilBuffer:!0,depthBuffer:!0,generateMipmaps:!0,flipY:!0,type:K});return r.texture.isRenderTargetTexture=!1,r}updateResolution(t){t!==this.renderTarget.width&&(this.renderTarget.dispose(),this.renderTarget=this.createRenderTarget(t),this.cubeCamera.renderTarget=this.renderTarget,this.sphereMesh.material.envMap=this.renderTarget.texture,this.sphereMesh.material.needsUpdate=!0)}onResize(t,r){const s=t,n=r;this.orthoCamera.position.set(0,0,100),this.orthoCamera.zoom=100,this.orthoCamera.left=s/-2,this.orthoCamera.right=s/2,this.orthoCamera.top=n/2,this.orthoCamera.bottom=n/-2,this.orthoCamera.updateProjectionMatrix();const o=Math.sqrt(s*s+n*n)/100*(.5+this.zoom/2);this.sphereMesh.scale.setScalar(o),this.temp.sphere.radius=o}computeRaycastRayDirection(t,r){const{orthoCamera:s,temp:n,cubeCamera:o}=this,{normal:i,normalMatrix:d,sphere:c}=n;if(t.setFromCamera(r,s),t.ray.intersectSphere(c,i))i.normalize();else return;d.getNormalMatrix(o.matrixWorld),o.getWorldPosition(t.ray.origin),t.ray.direction.set(0,0,1).reflect(i),t.ray.direction.x*=-1,t.ray.direction.applyNormalMatrix(d).multiplyScalar(-1)}render(t,r,s){s.matrixWorld.decompose(this.temp.t,this.temp.r,this.temp.s),this.cubeCamera.position.copy(this.temp.t),this.cubeCamera.quaternion.setFromEuler(this.temp.e).premultiply(this.temp.r),this.cubeCamera.update(t,r),t.render(this.sphereMesh,this.orthoCamera)}}const O=new Ce,B=new ge;let R,l,p,w,m,S,b=new re;const D=new ne,xe=new k,G=new U;G.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.5/");xe.setDRACOLoader(G);const P=new ae,f=[];let z,y;const a={zoom:0,resolution:896,progress:0,fisheye:!1,playPause:()=>{},scrubCurve:()=>{},scrubTween:null};async function Ue(e){S=e,z=S.addFolder("Scene"),R=new W,app.appendChild(R.dom),l=new J({powerPreference:"high-performance"}),l.toneMapping=ee,app.appendChild(l.domElement),z.add({dpr:l.getPixelRatio()},"dpr",.5,window.devicePixelRatio,.1).onChange(s=>{l.setPixelRatio(s)}),p=new te(50,1,.1,200),p.position.set(0,2,6),p.name="Camera",w=new se,w.add(D),m=new j(p,l.domElement),m.enableDamping=!0,m.dampingFactor=.05,m.target.set(0,2,0),Se(),window.addEventListener("resize",E),E();let t=Date.now();app.addEventListener("pointerdown",()=>{t=Date.now()}),app.addEventListener("pointerup",s=>{Date.now()-t<200&&(Pe(s),Te())});const r=new ye(w,{loadingHelper:O});r.preset=we.skidpan,r.setBGType("Default"),r.setEnvType("HDRI"),await Promise.all([r.updateAll(),Re()]),Me()}function E(){const e=window.innerWidth,t=window.innerHeight;p.aspect=e/t,p.updateProjectionMatrix(),l.setSize(e,t),y.onResize(e,t)}function ve(){R.update(),B.update(),m.update(),a.fisheye?y.render(l,w,p):l.render(w,p)}function Me(){l.setAnimationLoop(ve)}const _=new I;function Te(){if(a.fisheye?y.computeRaycastRayDirection(P,b):P.setFromCamera(b,p),P.intersectObject(D,!0,f),f.length&&f[0].instanceId!==void 0){const e=f[0].object;_.setHSL(Math.random(),1,.5),e.setColorAt(f[0].instanceId,_),e.instanceColor.needsUpdate=!0}f.length=0}function Pe(e){b.x=e.clientX/window.innerWidth*2-1,b.y=-(e.clientY/window.innerHeight)*2+1}async function Re(){console.log('"Hintze-Hall - VR Tour" (https://skfb.ly/p8zyZ) by Another-me is licensed under Creative Commons Attribution (http://creativecommons.org/licenses/by/4.0/).');const t=(await he(me.hintze_hall.url,{loadingHelper:O})).scene;t.traverse(c=>{c.isMesh&&(c.castShadow=!0,c.receiveShadow=!0,c.selectOnRaycast=t)}),w.add(t);const r=new oe(.6,.3,64,64),s=10,n=new ie(r,new ce({roughness:.3}),s);n.castShadow=!0,n.receiveShadow=!0,n.name="torusknots",D.add(n);const o=new de,i=new F,d=new I;for(let c=0;c<s;c++){o.identity();const u=c%2===0?-1:1,C=19,x=c*C/(s/2)-C,v=Math.random()*Math.PI*2,M=Math.random()*Math.PI*2,T=Math.random()*Math.PI*2;i.setFromEuler(new L(v,M,T)),o.makeRotationFromQuaternion(i),o.setPosition(u*10,2.5,x),n.setMatrixAt(c,o),n.setColorAt(c,d.set(Math.random(),Math.random(),Math.random()))}n.computeBoundingSphere(),n.instanceMatrix.needsUpdate=!0,n.instanceColor.needsUpdate=!0}function Se(){y=new be({resolution:a.resolution}),De()}function De(){function e(u){const C=new le;return u.forEach(x=>{const[v,M,T,H]=x,A=new pe(new h(...v),new h(...M),new h(...T),new h(...H));C.add(A)}),C}const t=e(Ee),r=e(_e),s={duration:4e4};function n(){const u=a.progress%1;t.getPointAt(u,p.position),r.getPointAt(u,m.target)}const o={t:0},i=new fe(o,B).repeat(1/0).to({t:1},s.duration).onUpdate(()=>{a.progress=o.t,n(),g.rangeInput.value=a.progress}).start().pause(),d=()=>{i.isPaused()?i.resume():i.isPlaying()?i.pause():i.start()};a.playPause=d,a.scrubCurve=n,a.scrubTween=i;const c=S.addFolder("Fisheye");c.add(a,"fisheye").listen(),c.add(a,"zoom",0,1,.01).onChange(()=>{y.zoom=a.zoom,y.onResize(window.innerWidth,window.innerHeight)}),c.add(a,"resolution",128,1024,128).onChange(u=>{y.updateResolution(u)}),ze()}const g={controlsDiv:document.createElement("div"),buttonsDiv:document.createElement("div"),fisheyeButton:document.createElement("button"),playPauseButton:document.createElement("button"),rangeInput:document.createElement("input")};function ze(){const e=g.controlsDiv;e.style.position="fixed",e.style.bottom="20px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.padding="15px",e.style.borderRadius="10px",e.style.display="flex",e.style.flexDirection="column",e.style.gap="10px",e.style.zIndex="1000",e.style.width="90%",e.style.boxShadow="inset 0 0 20px rgba(0,0,0,0.5)";const t=g.buttonsDiv;t.style.display="flex",t.style.gap="10px",t.style.justifyContent="center";function r(d){d.style.padding="8px 16px",d.style.opacity="0.8",d.style.backgroundColor="#333",d.style.color="white",d.style.border="1px solid #555",d.style.borderRadius="5px",d.style.cursor="pointer",d.style.fontSize="14px"}const s=g.fisheyeButton;s.textContent="Fisheye Off",r(s),s.onclick=()=>{a.fisheye=!a.fisheye,s.textContent=a.fisheye?"Fisheye On":"Fisheye Off",s.style.color=a.fisheye?"#00ff00":"white"};const n=g.playPauseButton;n.textContent="Play",r(n),n.onclick=()=>{a.playPause(),a.scrubTween.isPaused()?n.textContent="Resume":a.scrubTween.isPlaying()?n.textContent="Pause":n.textContent="Play"},t.appendChild(s),t.appendChild(n);const o=document.createElement("div");o.style.display="flex",o.style.flexDirection="column",o.style.alignItems="center",o.style.gap="5px";const i=g.rangeInput;i.type="range",i.min="0",i.max="1",i.step="0.001",i.value=a.progress,i.style.width="100%",i.addEventListener("input",d=>{a.progress=parseFloat(d.target.value),a.scrubCurve(),m.update();const c=ue.mapLinear(a.progress,0,1,0,a.scrubTween._duration);Le(a.scrubTween,c)}),o.appendChild(i),e.appendChild(t),e.appendChild(o),document.body.appendChild(e)}const Ee=[[[-8.1648,2.4362,-8.072],[-8.1648,2.4362,-16.7769],[-1.6856,2.4362,-18.7521],[-1.6856,2.4362,-23.3563]],[[-1.6856,2.4362,-23.3563],[-1.6856,2.4362,-28.6741],[-1.6856,7.4758,-36.2053],[-1.6856,7.4758,-38.1573]],[[-1.6856,7.4758,-38.1573],[-1.6856,7.4758,-44.1211],[-10.9197,11.83,-43.002],[-18.5107,11.83,-43.002]],[[-18.5107,11.83,-43.002],[-20.911,11.83,-43.002],[-20.5255,11.83,-39.1374],[-20.5255,11.83,-35.6584]],[[-20.5255,11.83,-35.6584],[-20.5255,11.83,-35.2449],[-20.5255,11.83,18.5126],[-20.5255,11.83,19.1497]],[[-20.5255,11.83,19.1497],[-20.5255,11.83,23.5848],[-19.3271,12.8087,23.5848],[-17.6154,13.83,23.5848]],[[-17.6154,13.83,23.5848],[-11.5613,17.4423,23.5848],[-7.6476,18.0658,23.5848],[-3.6236,19.6142,23.5848]],[[-3.6236,19.6142,23.5848],[10.3927,25.0076,23.5848],[-30.6725,17.6138,-29.0267],[0,17.6138,-29.0267]],[[0,17.6138,-29.0267],[30.6725,17.6138,-29.0267],[-10.3927,25.0076,23.5848],[3.6236,19.6142,23.5848]],[[3.6236,19.6142,23.5848],[7.6476,18.0658,23.5848],[11.5613,17.4423,23.5848],[17.6154,13.83,23.5848]],[[17.6154,13.83,23.5848],[19.3271,12.8087,23.5848],[20.5255,11.83,23.5848],[20.5255,11.83,19.1497]],[[20.5255,11.83,19.1497],[20.5255,11.83,18.5126],[20.5255,11.83,-35.2449],[20.5255,11.83,-35.6584]],[[20.5255,11.83,-35.6584],[20.5255,11.83,-39.1374],[20.911,11.83,-43.002],[18.5107,11.83,-43.002]],[[18.5107,11.83,-43.002],[10.9198,11.83,-43.002],[1.6856,7.4758,-44.1211],[1.6856,7.4758,-38.1573]],[[1.6856,7.4758,-38.1573],[1.6856,7.4758,-36.2053],[1.6856,2.4362,-28.6741],[1.6856,2.4362,-23.3563]],[[1.6856,2.4362,-23.3563],[1.6856,2.4362,-18.7521],[8.1648,2.4362,-16.7769],[8.1648,2.4362,-8.072]],[[8.1648,2.4362,-8.072],[8.1648,2.4362,.8368],[6.0548,2.4362,7.3956],[0,2.4362,7.3956]],[[0,2.4362,7.3956],[-6.0548,2.4362,7.3956],[-8.1648,2.4362,.8368],[-8.1648,2.4362,-8.072]]],_e=[[[-8.9216,3.9636,-7.0829],[-8.9216,3.9636,-19.5964],[3.16,3.9636,-20.5057],[3.16,3.9636,-24.1335]],[[3.16,3.9636,-24.1335],[3.16,3.9636,-26.6773],[2.2985,5.4408,-31.246],[.8767,6.3182,-32.8328]],[[.8767,6.3182,-32.8328],[-4.2808,9.5009,-38.589],[-6.1502,11.4063,-40.6487],[-14.3531,11.4063,-40.6487]],[[-14.3531,11.4063,-40.6487],[-15.2043,11.4063,-40.6487],[-18.0104,11.4063,-40.6487],[-18.0104,11.4063,-38.5479]],[[-18.0104,11.4063,-38.5479],[-18.0104,11.4063,-38.1851],[-18.0104,11.4063,13.1709],[-18.0104,11.4063,13.7299]],[[-18.0104,11.4063,13.7299],[-18.0104,11.4063,17.6216],[-16.9863,10.967,17.6216],[-15.4569,11.4063,17.6216]],[[-15.4569,11.4063,17.6216],[-9.8653,13.0121,17.6216],[-7.4199,13.6265,17.6216],[-4.0498,16.0368,17.6216]],[[-4.0498,16.0368,17.6216],[7.4644,24.2716,17.6216],[-29.9964,20.4122,-31.8682],[0,20.4122,-31.8682]],[[0,20.4122,-31.8682],[29.9964,20.4122,-31.8683],[-7.4643,24.2716,17.6216],[4.0498,16.0368,17.6216]],[[4.0498,16.0368,17.6216],[7.4199,13.6265,17.6216],[9.8653,13.0121,17.6216],[15.4569,11.4063,17.6216]],[[15.4569,11.4063,17.6216],[16.9863,10.967,17.6216],[18.0104,11.4063,17.6216],[18.0104,11.4063,13.7299]],[[18.0104,11.4063,13.7299],[18.0104,11.4063,13.1709],[18.0104,11.4063,-38.1851],[18.0104,11.4063,-38.5479]],[[18.0104,11.4063,-38.5479],[18.0104,11.4063,-40.6487],[15.2043,11.4063,-40.6487],[14.3531,11.4063,-40.6487]],[[14.3531,11.4063,-40.6487],[6.1502,11.4063,-40.6487],[4.2808,9.5009,-38.589],[-.8767,6.3182,-32.8328]],[[-.8767,6.3182,-32.8328],[-2.2985,5.4408,-31.246],[-3.16,3.9636,-26.6773],[-3.16,3.9636,-24.1335]],[[-3.16,3.9636,-24.1335],[-3.16,3.9636,-20.5057],[8.9216,3.9636,-19.5964],[8.9216,3.9636,-7.0829]],[[8.9216,3.9636,-7.0829],[8.9216,3.9636,2.2666],[9.3495,3.9636,14.7905],[0,3.9636,14.7905]],[[0,3.9636,14.7905],[-9.3495,3.9636,14.7905],[-8.9216,3.9636,2.2666],[-8.9216,3.9636,-7.0829]]];function Le(e,t,r=!0){if(e._pauseStart=performance.now(),e._startTime=e._pauseStart-t,!r)return e;let s=t/e._duration;s=e._duration===0||s>1?1:s;const n=e._easingFunction(s);return e._updateProperties(e._object,e._valuesStart,e._valuesEnd,n),e._onUpdateCallback&&e._onUpdateCallback(e._object,s),e}export{Ue as default};
